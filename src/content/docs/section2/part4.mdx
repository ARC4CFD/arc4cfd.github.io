---
title: 'Pre-processing'
---

import Box from '../../../components/Box.astro';
import Caption from '../../../components/Caption.astro';
import CustomAside from '../../../components/CustomAside.astro';
import { Tabs, TabItem } from '@astrojs/starlight/components';
import CodeFetch from '../../../components/CodeFetch.astro';

:::note[Learning Objectives]
By the end of this section, you should be able to:
1. Construct a mesh and send to HPC
2. Configure numerical setup with HPC consideration
3. Understand interconnectivity among CFD tools
:::

## Setting up the simulation for HPC computations

This pre-processing step is common to the classical CFD workflow and is presented here for completness. 



## Generate geometry
The geometry 



partition

gmsh -2 -setnumber domain_size 1.0 source/square.geo -o ./square.msh




## Generate mesh


### Deciding the type of mesh to use

Structured vs unstructured



### How to generate the mesh






Discussion reconstructParMesh for openFoam




## Configure numerical setup





## Example: Grid generation
For this example, we use the opensource meshing software [Gmsh](https://gmsh.info) to discretize domain.  Other open-source meshing alternatives are found directly in OpenFoam's [blockMesh](https://www.openfoam.com/documentation/user-guide/4-mesh-generation-and-conversion/4.3-mesh-generation-with-the-blockmesh-utility) or with [Salome](https://www.salome-platform.org/?page_id=374)


<Tabs group="tab-group">
    <TabItem label="Code">
        ```python title="hwmpi.py"
        # Hellow world in parallel

        from mpi4py import MPI

        comm = MPI.COMM_WORLD
        worker = comm.Get_rank()
        size = comm.Get_size()

        print("Hello world from worker ", worker, " of ", size)
        ```
    </TabItem>
    <TabItem label="Run command">
<CodeFetch rawURL='https://raw.githubusercontent.com/ARC4CFD/arc4cfd/dev/section1/isleap.py' lang='python' meta="title='isleap.py'" />

    </TabItem>
</Tabs>





Mesh for the domain is generated using gmsh. 3 sets of mesh corresponding to varying y+ values are generated for the simulation. The boundary layer is modeled using SA turbulence model and the first cell y+ value in the models are constrained within 5. Table 1 gives the list of mesh and time step parameters considered for each y+ cases. Meshed domains are shown in Figs. 2-4. 





## Example: Simulation setup
Standard SA model is used for near-wall turbulence modeling while Smagorinsky LES sub-grid scale (SGS) model is implemented at wall-normal distances larger than a value specified from default wall-distance coefficient. (Refer to Molina et al (2017) for SU2 formulations). 
In SU2, 2nd order dual-time stepping scheme is used for time marching method with 5 inner iterations per time step. Total simulation duration is 400ms which corresponds to roughly 10 flow passes across stream wise direction. Results are saved every 2ms. 
