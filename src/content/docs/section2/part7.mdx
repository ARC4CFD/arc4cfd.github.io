---
title: 'A posteriori analysis and visualization'
---

:::note[Learning Objectives]
By the end of this section, you should be able to:
1. Organize and plan result files on the cluster
2. Perform common 'a posteriori' analysis technique in CFD
3. Visualize flow field using various methods
:::

## Postprocessing CFD simulations on HPC: Overview
![HPCcompromise.](../../../assets/figs_section2/ARC4CFD_workflow_POSTPROC.png "Process simulations of the CFD simulation")

After completing [section 2.6](https://arc4cfd.github.io/section2/part6/), our large-scale CFD simulation is now running on the HPC system, and printing results as specified by the user. We also learned how to monitor the simulation using simple line commands on terminal, and the very useful plotting tool [Gnuplot](http://www.gnuplot.info/). At this point **the fun part** begins as we can dive into the visualization of the results. Before THAT however, **be mindful and ...**


## Organize and plan result files on the cluster
Assuming that your simulation ran for **enough** time based on your estimate, the job is now **complete** and results can be move in the **long term** storage where analysis can be performed on them without worrying about data getting purged by the system administrators. The **long term** storage unit, as mentioned in [section 2.6](http://localhost:4321/section2/part6), is the `/projects` directory connected to your supervisor's (or principal investigator) account. Although, the `/project` space will probably have hundreds of terabytes (TB) of storage capability, IT WILL ALWAYS have a limit, especially in the **total number** of files that can be stored. 

:::note[Keep in mind]
1. `/projects` is a **group** WatchDirectoryFlags, meaning that whatever you do inside it **will affect** and **potential harm** the workflow of other researchers in the same group.
2. **Always merge parallel output files before moving them** to `/project`. This is a crucial step as we saw how a very simple simulation like the BFS on 64 processors generated close to 100 thousands files. 
:::

So far we have seen 2 common ways to move files between two locations in the HPC system: the `cp` parseCommandLine, and the `sftp` protocol. We will show below three more **secure** and **much faster** ways of transferring a LARGE quantity of data.

### The Secure Copy Protocol (SCP)
The secure copy protocol or simply `scp` is comman-line tool to **securely** transfer data. The **very important** feature of `scp` is that all files and password that are being transferred are encrypted, so that any third-party user analyzing the traffic cannot retreive sensitive information. `scp` is therefore highly recommended when dealing with sensitive or proprietary data. The basic syntax for `scp` is:
```bash
[username@gra-login1 ~/scratch/01_BFS_openFOAM]$ scp options user@source_host:/path-to-files user@dest_host:/path-to-dir
```
Where:
- **Options**: the user might specify options to change the behavior of `scp`. Commonly used options are:
    1. `-P`: specifies the **port** to connect on the remote host.
    2. `-p`: preserves **modification times, access times, and modes** from original files.
    3. `-r`: recursively copy entire directories.

- **user@source_host:/path-to-files**: this is the path of the local or remote file(s) we are about to transfer. 
- **user@dest_host:/path-to-dir**: this it the path to the final destination of the files(s) we are about to transfer.


## Common 'a posteriori' analysis techniques in CFD (JPH: please focus on the HPC aspects, not the turbulence aspects)
Explain the most important type of 'a posteriori' analysis [TO DO]. 
1. Instantaneous flow.
2. Long time average
3. Phase average
4. First order statistics
5. Second order statistics

## Visualization
Explain common ways of visualizing the flow: [TO DO]
1. Download data on local machine.
3. Use VDI nodes for flow visualization.
2. [parallel/remote  visualization](https://docs.scinet.utoronto.ca/index.php/Visualization)

## Grid convergence and code validation 
Explain the importance of a grid sensitivity study and how to carry it out [TO DO]

## Data transfer
Considerations/ Globus etc