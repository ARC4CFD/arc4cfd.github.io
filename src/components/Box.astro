---
// import { Icon } from '@astrojs/starlight/components';
import { Image } from 'astro:assets'
import type { ImageMetadata } from 'astro';
import Path from 'path';

const { imgSrc } = Astro.props;
const { colour } = Astro.props;

const images = import.meta.glob<{ default: ImageMetadata}>("/src/assets/**/*.{jpeg,jpg,png,gif}");
const absPath = Path.isAbsolute(imgSrc? imgSrc : '/')? imgSrc : Path.join('/src/content', Astro.url.pathname, imgSrc).replace(/\\/g,'/');
// if (!images[imgSrc]) throw new Error(`"${imgSrc}" does not exist in glob: "src/assets/*.{jpeg,jpg,png,gif}"`);
---
<!-- "float:right; width: 8rem; height: 8rem; margin:5px;" -->

<!-- style="position:absolute; top:-2.5rem; width: 8rem; height: 8rem; inset-inline-end: 1.5rem; margin:1em;" -->
<div class={`highlight-box content ${absPath}`}>
	{(!images[absPath]) ? "" : <span style="float:right; width: 3rem; height: 3rem; margin:1em 1.5em;"/> }
	<section>
		<slot />
	</section>
	{(!images[absPath]) ? "" : <Image src={images[absPath]()} alt="Box icon" style="position:absolute; top:-2.5rem; width: 8rem; height: 8rem; inset-inline-end: 1.5rem;"/> }
	<!-- <Icon name={ imgSrc } size="6rem"/> -->
</div>

<style>
	:global(section > *) + .highlight-box {
		margin: 4rem 0;
	}

	.highlight-box {
		position: relative;
		padding-block: 2rem;
		padding-inline-start: 2rem;
		padding-inline-end: 4rem;
		border: 1px solid var(--sl-color-purple);
		background-color: var(--sl-color-purple-low);
		color: var(--sl-color-purple-high);
	}

	@supports (mask: var(--box-icon-url) no-repeat center bottom / 100%) or
		(-webkit-mask: var(--box-icon-url) no-repeat center bottom / 100%) {
		.highlight-box::before {
			content: '';
			position: absolute;
			top: -2.5rem;
			inset-inline-end: 1.5rem;
			width: 8rem;
			height: 8rem;
			background: var(--box-icon-url) no-repeat center center / 100%;
		}
	}

	:global(ol) {
		padding-left: 1.5rem;
	}
</style>
